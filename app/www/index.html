<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <meta name="msapplication-tap-highlight" content="no" />
        <title>Hello World</title>
    </head>
    <body>
        <div class="app">
            <p>View console for output. You should use Chrome's, it works better than logcat.</p>
        </div>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript">
            var uuid = '39457783-362f-4343-8846-7fec4fc6268f';

            document.addEventListener('deviceready', function(){
                console.log('Pebble', Pebble);

                var genericHandler = function(name){
                    return function(err, info){
                        if (name == 'DATA'){
                            Pebble.sendAckToPebble(info.transaction, function(err, transaction){
                                if (err) return console.error(err);
                            });
                        }
                    };
                }

                Pebble.registerReceivedDataHandler(uuid, genericHandler('DATA'));
                Pebble.registerReceivedAckHandler(uuid, genericHandler('ACK'));
                Pebble.registerReceivedNackHandler(uuid, genericHandler('NACK'));

                var alphabet = ('ABCDEFGHIJKLMNOPQRSTUVWXYZ').split('');
                var l = 0;

                function sendLetter(){
                    var data = [ {type:'string', key:1, value:alphabet[l%26], length:0} ];
                    Pebble.sendDataToPebble(uuid, data, sendLetter);
                    l++;
                }
                sendLetter();
                
            });
        </script>
    </body>
</html>
